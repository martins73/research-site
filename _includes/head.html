<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">


{% assign meta_desc = page.description | default: site.description %}

<link rel="canonical" href="{{ page.url | absolute_url }}">

<title>
  {% if page.active_page == 'home' %}
    {{ page.title }}
  {% else %}
    {% if page.title %}{{ page.title }} | {% endif %}{{ site.title }}
  {% endif %}
</title>

<meta name="description" content="{{ site.author.job_title }} at {{ site.author.affiliation_short }}. {{ meta_desc }}">

<meta property="og:title" content="{{ page.title | default: site.og_title }}">
<meta property="og:description" content="{{ meta_desc }}">
<meta property="og:url" content="{{ page.url | absolute_url }}">
<meta property="og:image" content="{{ site.og_image | absolute_url }}">
<meta property="og:image:type" content="{{ site.og_image_type }}">
<meta property="og:image:width" content="{{ site.og_image_width }}">
<meta property="og:image:height" content="{{ site.og_image_height }}">
<meta property="og:type" content="website">

<meta name="twitter:card" content="{{ site.twitter_card }}">

<link rel="icon" type="image/svg+xml" href="{{ '/assets/logos/favicon.svg' | relative_url }}?v={{ site.time | date: '%s' }}">

<link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}?v={{ site.time | date: '%s' }}">

{% if site.google_analytics %}
<script async src="https://www.googletagmanager.com/gtag/js?id={{ site.google_analytics }}"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', '{{ site.google_analytics }}');
</script>
{% endif %}

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Person",
  "name": "{{ site.author.name }}",
  "alternateName": "{{ site.author.alternate_name }}",
  "givenName": "{{ site.author.given_name }}",
  "familyName": "{{ site.author.family_name }}",
  "jobTitle": "{{ site.author.job_title }}",
  "description": "{{ site.description }}",
  "knowsAbout": [
    {% for topic in site.schema.knowsAbout %}
    { "@type": "Thing", "name": "{{ topic }}" }{% unless forloop.last %},{% endunless %}
    {% endfor %}
  ],
  "affiliation": {
    "@type": "Organization",
    "name": "{{ site.author.affiliation }}",
    "url": "{{ site.author.affiliation_url }}"
  },
  "alumniOf": [
    {% for school in site.schema.alumni_of %}
    { "@type": "CollegeOrUniversity", "name": "{{ school.name }}" }{% unless forloop.last %},{% endunless %}
    {% endfor %}
  ],
  "email": "{{ site.author.email }}",
  "url": "{{ site.url }}",
  "sameAs": [
    "{{ site.social.linkedin }}",
    "{{ site.social.google_scholar }}",
    "{{ site.social.goodreads }}"
  ]
}
</script>

<!-- Early Guards: Must run before first paint to prevent visual glitches -->
<script>
  // 1. Dark mode: apply saved theme before render to prevent white flash
  (function() {
    var theme = localStorage.getItem('theme') || 'light';
    document.documentElement.setAttribute('data-theme', theme);
  })();

  // 2. Mobile breakpoint: shared constant used by all scripts
  window.MOBILE_BREAKPOINT_PX = 768;

  // 3. Scroll guard: disable browser scroll restoration before it fires
  (function() {
    if (!window.matchMedia('(max-width: ' + window.MOBILE_BREAKPOINT_PX + 'px)').matches) return;
    if (sessionStorage.getItem('autoScrollToContent') !== '1') return;
    if ('scrollRestoration' in history) history.scrollRestoration = 'manual';
  })();
</script>
